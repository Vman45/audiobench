macro Waveform(buffer_pos, phase):(value) {
    AUTO amplitude = Modulator(buffer_pos, phase) * intensity[buffer_pos?] + (1.0 - intensity[buffer_pos?]);
    AUTO value = Carrier(buffer_pos, phase) * amplitude;
}

if global_update_feedback_data {
    [60]FLOAT feedback;
    for i = 0 to 60 no_unroll {
        FLOAT fphase = Itof(i) / 59.0;
        feedback[i] = Waveform(0, fphase)[0?];
    }
    SetGraphFeedback(feedback);
}